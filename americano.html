<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Americano | Harmonic Collection Cocktail Menu</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Limelight&display=swap" rel="stylesheet">
<style>
:root{
  --bitter:#c20114;
  --vermouth:#8b2500;
  --soda:#ff8c00;
  --dark:#1d1d1d;
  --gap:1.5rem;
  --radius:1rem;
  font-size:16px;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:
    radial-gradient(ellipse at 30% 20%, rgba(194,1,20,0.25), transparent 50%),
    radial-gradient(ellipse at 70% 80%, rgba(255,140,0,0.2), transparent 50%),
    radial-gradient(ellipse at 50% 50%, rgba(194,1,20,0.15), transparent 60%),
    linear-gradient(135deg, rgba(194,1,20,0.1) 0%, transparent 50%, rgba(255,140,0,0.08) 100%),
    var(--dark);
  color:#fff;
  font-family:monospace;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  min-height:100vh;
  padding:var(--gap);
  padding-top:calc(var(--gap) * 2);
  padding-bottom:calc(var(--gap) * 2);
  position:relative;
  overflow-x:hidden;
  overflow-y:auto;
  cursor:none;
}
body::after{
  content:'';
  position:fixed;
  width:600px;
  height:600px;
  background:radial-gradient(circle, rgba(194,1,20,0.5), rgba(255,140,0,0.3) 30%, rgba(194,1,20,0.1) 60%, transparent 80%);
  border-radius:50%;
  pointer-events:none;
  left:var(--mouse-x, 50%);
  top:var(--mouse-y, 50%);
  transform:translate(-50%, -50%);
  z-index:0;
  mix-blend-mode:screen;
  will-change:left, top, transform, opacity;
  filter:blur(60px);
  animation:breathe 3s ease-in-out infinite;
  opacity:0.6;
}
@keyframes breathe{
  0%, 100%{
    transform:translate(-50%, -50%) scale(1);
    opacity:0.4;
  }
  50%{
    transform:translate(-50%, -50%) scale(1.3);
    opacity:0.8;
  }
}
body::before{
  content:'';
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at 20% 30%, rgba(194,1,20,0.15), transparent 50%),
    radial-gradient(circle at 80% 70%, rgba(255,140,0,0.1), transparent 50%),
    radial-gradient(circle at 50% 50%, rgba(194,1,20,0.08), transparent 60%);
  animation:lightPulse 8s ease-in-out infinite;
  pointer-events:none;
  z-index:0;
}
@keyframes lightPulse{
  0%, 100%{
    opacity:0.4;
    transform:scale(1);
  }
  50%{
    opacity:0.8;
    transform:scale(1.15);
  }
}
.container{
  display:flex;
  gap:3rem;
  align-items:center;
  justify-content:center;
  width:100%;
  max-width:1400px;
  position:relative;
  z-index:1;
}
.cocktail-image{
  flex:1;
  max-width:500px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.cocktail-image img{
  width:100%;
  max-width:400px;
  height:auto;
  object-fit:contain;
  filter:drop-shadow(0 10px 20px rgba(0,0,0,0.3));
  animation:float-image 8s ease-in-out infinite;
}
@keyframes float-image{
  0%{transform:translate(0, 0) rotate(0deg);}
  25%{transform:translate(40px, -50px) rotate(5deg);}
  50%{transform:translate(-35px, -60px) rotate(-5deg);}
  75%{transform:translate(-40px, -40px) rotate(3deg);}
  100%{transform:translate(0, 0) rotate(0deg);}
}
@media (max-width:1024px){
  .container{
    flex-direction:column;
    gap:2rem;
  }
  .cocktail-image{
    max-width:100%;
  }
  .cocktail-image img{
    max-width:300px;
  }
}
.card{
  flex:1;
  max-width:420px;
  background:#000;
  border-radius:var(--radius);
  overflow:hidden;
  position:relative;
  box-shadow:0 10px 30px rgba(0,0,0,.6);
}
.stripes{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
}
.stripes span{
  flex:1;
  transition:transform .35s ease;
}
.stripes .bitter{background:var(--bitter);}
.stripes .vermouth{background:var(--vermouth);}
.stripes .soda{background:var(--soda);}
.card:hover .bitter{transform:translateX(-4px);}
.card:hover .soda{transform:translateX(4px);}
.content{
  position:relative;
  z-index:2;
  padding:var(--gap);
}
.badge{
  display:inline-block;
  background:#fff;
  color:var(--dark);
  padding:.25rem .5rem;
  border-radius:.25rem;
  font-size:.75rem;
}
h2{
  font-size:1.75rem;
  margin:.5rem 0 0;
  font-family:"Limelight", sans-serif;
  font-weight:400;
  font-style:normal;
}
.story{
  font-family:'Ma Shan Zheng',cursive;
  font-size:1.15rem;
  line-height:1.8;
  margin:1rem 0 1.5rem;
}
.footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.ratio{font-size:.9rem;color:#ccc}
details{display:inline-block}
summary{
  list-style:none;
  background:var(--bitter);
  color:#fff;
  padding:.5rem 1rem;
  font-weight:600;
  letter-spacing:1px;
  border-radius:.25rem;
  cursor:pointer;
  transition:background .25s;
}
summary:hover{background:#fff;color:var(--dark)}
summary::-webkit-details-marker{display:none}
.recipe{
  margin-top:1rem;
  padding:1rem;
  border:1px solid var(--bitter);
  border-radius:.5rem;
  background:rgba(0,0,0,.5);
}
.recipe h3{font-size:1.1rem;margin-bottom:.5rem}
.recipe p{margin:.25rem 0}
small{display:block;margin-top:.5rem;color:#aaa}
@import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Vend+Sans:opsz,wght@14..24,100..900&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Limelight&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Bitcount+Prop+Single&display=swap');
.back-btn{
  position:fixed;
  top:2rem;
  left:2rem;
  z-index:10;
  background:rgba(0,0,0,0.7);
  color:#fff;
  padding:0.75rem 1.5rem;
  border-radius:2rem;
  text-decoration:none;
  font-size:0.9rem;
  backdrop-filter:blur(10px);
  border:1px solid rgba(255,255,255,0.1);
  transition:all 0.3s ease;
  display:flex;
  align-items:center;
  gap:0.5rem;
}
.back-btn:hover{
  background:rgba(0,0,0,0.9);
  transform:translateX(-5px);
  border-color:var(--bitter);
}
.back-btn::before{
  content:'←';
  font-size:1.2rem;
}
.coffee-bean{
  position:fixed;
  width:80px;
  height:80px;
  background-image:url('coffee-bean.png');
  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;
  opacity:0.7;
  z-index:0;
  pointer-events:auto;
  cursor:pointer;
  transition:transform 0.3s ease, opacity 0.3s ease;
  animation:bean-float 6s ease-in-out infinite;
  filter:brightness(0.8) contrast(1.2);
}
.coffee-bean:nth-child(1){
  top:8%;
  left:8%;
  animation-delay:0s;
}
.coffee-bean:nth-child(2){
  top:8%;
  right:12%;
  animation-delay:1s;
}
.coffee-bean:nth-child(3){
  top:25%;
  left:5%;
  animation-delay:2s;
}
.coffee-bean:nth-child(4){
  top:25%;
  right:8%;
  animation-delay:1.5s;
}
.coffee-bean:nth-child(5){
  top:45%;
  left:12%;
  animation-delay:0.5s;
}
.coffee-bean:nth-child(6){
  top:45%;
  right:15%;
  animation-delay:2.5s;
}
.coffee-bean:nth-child(7){
  top:65%;
  left:6%;
  animation-delay:3s;
}
.coffee-bean:nth-child(8){
  top:65%;
  right:10%;
  animation-delay:3.5s;
}
.coffee-bean:nth-child(9){
  bottom:8%;
  left:10%;
  animation-delay:4s;
}
.coffee-bean:nth-child(10){
  bottom:8%;
  right:12%;
  animation-delay:4.5s;
}
@keyframes bean-float{
  0%, 100%{
    transform:translateY(0) rotate(0deg);
    opacity:0.7;
  }
  50%{
    transform:translateY(-30px) rotate(180deg);
    opacity:0.9;
  }
}
.coffee-bean:hover{
  transform:translateY(-20px) rotate(15deg) scale(1.3);
  opacity:1;
  filter:brightness(1) contrast(1.3);
}
.light-dot{
  position:fixed;
  width:4px;
  height:4px;
  background:rgba(255,140,0,0.8);
  border-radius:50%;
  pointer-events:none;
  z-index:0;
  box-shadow:0 0 10px rgba(255,140,0,0.6), 0 0 20px rgba(194,1,20,0.4);
  animation:twinkle 3s ease-in-out infinite;
}
.light-dot:nth-child(6){
  top:15%;
  left:10%;
  animation-delay:0s;
}
.light-dot:nth-child(7){
  top:25%;
  right:15%;
  animation-delay:0.5s;
}
.light-dot:nth-child(8){
  top:60%;
  left:20%;
  animation-delay:1s;
}
.light-dot:nth-child(9){
  bottom:20%;
  right:25%;
  animation-delay:1.5s;
}
.light-dot:nth-child(10){
  top:40%;
  right:10%;
  animation-delay:2s;
}
@keyframes twinkle{
  0%, 100%{
    opacity:0.3;
    transform:scale(1);
  }
  50%{
    opacity:1;
    transform:scale(1.5);
  }
}
.game-section{
  width:100%;
  max-width:1200px;
  margin-top:calc(var(--gap) * 3);
  padding:var(--gap);
  position:relative;
  z-index:1;
}
.game-container{
  background:linear-gradient(135deg, rgba(19,20,26,0.85), rgba(8,9,14,0.75));
  border-radius:var(--radius);
  padding:var(--gap);
  border:2px solid rgba(255,140,0,0.3);
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  box-shadow:0 20px 60px rgba(0,0,0,0.7);
}
.game-title{
  font-size:1.8rem;
  font-family:"Limelight", sans-serif;
  font-weight:400;
  color:rgba(255,140,0,0.9);
  text-align:center;
  margin-bottom:1rem;
  text-shadow:0 0 20px rgba(255,140,0,0.5);
}
.game-info{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:1rem;
  color:#fff;
  font-size:0.9rem;
}
.game-canvas-wrapper{
  position:relative;
  width:100%;
  background:#1a1a2e;
  border-radius:0.5rem;
  overflow:hidden;
  border:3px solid rgba(255,140,0,0.4);
  box-shadow:inset 0 0 30px rgba(0,0,0,0.5);
}
#gameCanvas{
  display:block;
  width:100%;
  height:500px;
  background:linear-gradient(to bottom, #87CEEB 0%, #87CEEB 60%, #8B4513 60%, #8B4513 100%);
  image-rendering:pixelated;
  image-rendering:-moz-crisp-edges;
  image-rendering:crisp-edges;
}
.game-controls{
  margin-top:1rem;
  text-align:center;
  color:#aaa;
  font-size:0.85rem;
}
.game-controls p{
  margin:0.25rem 0;
}
.start-btn{
  background:linear-gradient(135deg, rgba(255,140,0,0.9), rgba(255,100,0,0.8));
  color:#fff;
  border:none;
  padding:0.75rem 2rem;
  border-radius:2rem;
  font-size:1rem;
  font-weight:bold;
  cursor:pointer;
  margin-bottom:1rem;
  box-shadow:0 5px 15px rgba(255,140,0,0.4);
  transition:transform 0.2s ease, box-shadow 0.2s ease;
  font-family:"Limelight", sans-serif;
}
.start-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 20px rgba(255,140,0,0.6);
}
.start-btn:active{
  transform:translateY(0);
}
.start-btn.hidden{
  display:none;
}
.victory-screen{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.85);
  backdrop-filter:blur(10px);
  -webkit-backdrop-filter:blur(10px);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:100;
  animation:fadeIn 0.5s ease;
}
.victory-screen.hidden{
  display:none;
}
@keyframes fadeIn{
  from{
    opacity:0;
  }
  to{
    opacity:1;
  }
}
.victory-content{
  background:linear-gradient(135deg, rgba(19,20,26,0.95), rgba(8,9,14,0.95));
  border-radius:var(--radius);
  padding:2rem;
  text-align:center;
  border:2px solid rgba(255,140,0,0.5);
  box-shadow:0 20px 60px rgba(0,0,0,0.8), 0 0 40px rgba(255,140,0,0.3);
  max-width:500px;
  width:90%;
  animation:slideUp 0.5s ease;
}
@keyframes slideUp{
  from{
    transform:translateY(50px);
    opacity:0;
  }
  to{
    transform:translateY(0);
    opacity:1;
  }
}
.victory-title{
  font-size:2.5rem;
  font-family:"Limelight", sans-serif;
  font-weight:400;
  color:rgba(255,140,0,0.9);
  margin-bottom:1.5rem;
  text-shadow:0 0 20px rgba(255,140,0,0.5);
}
.victory-cocktail{
  margin:1.5rem 0;
}
.victory-cocktail img{
  width:120px;
  height:auto;
  filter:drop-shadow(0 10px 20px rgba(255,140,0,0.4));
  animation:float 3s ease-in-out infinite;
}
@keyframes float{
  0%, 100%{
    transform:translateY(0);
  }
  50%{
    transform:translateY(-10px);
  }
}
.victory-message{
  font-size:1.2rem;
  color:#fff;
  margin:1rem 0;
}
.victory-reward{
  font-size:1rem;
  color:#ccc;
  margin:1rem 0;
}
.victory-reward strong{
  color:rgba(255,140,0,0.9);
  font-family:"Limelight", sans-serif;
}
.victory-score{
  font-size:1.1rem;
  color:rgba(255,140,0,0.9);
  margin:1.5rem 0;
  font-weight:bold;
}
.victory-buttons{
  display:flex;
  gap:1rem;
  justify-content:center;
  margin-top:1.5rem;
  flex-wrap:wrap;
}
.victory-btn{
  background:linear-gradient(135deg, rgba(255,140,0,0.9), rgba(255,100,0,0.8));
  color:#fff;
  border:none;
  padding:0.75rem 1.5rem;
  border-radius:2rem;
  font-size:1rem;
  font-weight:bold;
  cursor:pointer;
  text-decoration:none;
  display:inline-block;
  box-shadow:0 5px 15px rgba(255,140,0,0.4);
  transition:transform 0.2s ease, box-shadow 0.2s ease;
  font-family:"Limelight", sans-serif;
}
.victory-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 20px rgba(255,140,0,0.6);
}
.victory-btn:active{
  transform:translateY(0);
}
</style>
</head>
<body>
<a href="index.html" class="back-btn">Back to Menu</a>
<div class="light-dot"></div>
<div class="light-dot"></div>
<div class="light-dot"></div>
<div class="light-dot"></div>
<div class="light-dot"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="coffee-bean"></div>
<div class="container">
  <div class="card">
    <div class="stripes">
      <span class="bitter"></span>
      <span class="vermouth"></span>
      <span class="soda"></span>
    </div>
    <div class="content">
      <div>
        <span class="badge">Aperitivo</span>
        <h2>Americano</h2>
      </div>
      <p class="story">
        1860s, Milano–Torino at Caffè Camparino.<br>
        Gaspare Campari's bitter met Antonio Carpano's vermouth, topped with a splash of soda for the arriving Americans.<br>
        Three sips and the perfect fourth rings—bitter, sweet, effortlessly resolved.
      </p>
      <div class="footer">
        <span class="ratio">1 : 1 : 1</span>
        <details>
          <summary>▶ View Recipe</summary>
          <div class="recipe">
            <h3>Americano Lead Sheet</h3>
            <p>Campari 30 ml</p>
            <p>Sweet vermouth 30 ml</p>
            <p>Soda water 30 ml</p>
            <small>Build / Highball / Orange half-wheel & lemon peel</small>
          </div>
        </details>
      </div>
    </div>
  </div>
  <div class="cocktail-image">
    <img src="americano.png" alt="Americano Cocktail">
  </div>
</div>
<div class="game-section">
  <div class="game-container">
    <h3 class="game-title">Cocktail Adventure</h3>
    <div class="game-info">
      <span>Score: <span id="score">0</span></span>
      <span>Lives: <span id="lives">3</span></span>
    </div>
    <div class="game-canvas-wrapper">
      <canvas id="gameCanvas"></canvas>
      <div id="victoryScreen" class="victory-screen hidden">
        <div class="victory-content">
          <h2 class="victory-title">Congratulations!</h2>
          <div class="victory-cocktail">
            <img src="americano.png" alt="Americano Cocktail">
          </div>
          <p class="victory-message">You've collected all coffee beans!</p>
          <p class="victory-reward">You earned an <strong>Americano</strong> cocktail!</p>
          <div class="victory-score">Final Score: <span id="finalScore">0</span></div>
          <div class="victory-buttons">
            <button id="playAgainBtn" class="victory-btn">Play Again</button>
            <a href="index.html" class="victory-btn">Back to Menu</a>
          </div>
        </div>
      </div>
    </div>
    <div class="game-controls">
      <button id="startGameBtn" class="start-btn">Start Game</button>
      <p>Use ← → to move, ↑ or Space to jump</p>
      <p>Collect coffee beans and avoid enemies!</p>
    </div>
  </div>
</div>
<script>
let mouseX = 0, mouseY = 0;
let lightX = 0, lightY = 0;
let lastMouseX = 0, lastMouseY = 0;
let velocity = 0;
let targetIntensity = 0.6;
let currentIntensity = 0.6;
const dynamicStyle = document.createElement('style');
dynamicStyle.id = 'dynamic-light-style';
document.head.appendChild(dynamicStyle);
function updateLight() {
  currentIntensity += (targetIntensity - currentIntensity) * 0.1;
  lightX += (mouseX - lightX) * 0.15;
  lightY += (mouseY - lightY) * 0.15;
  document.documentElement.style.setProperty('--mouse-x', lightX + 'px');
  document.documentElement.style.setProperty('--mouse-y', lightY + 'px');
  const blurAmount = 60 + Math.min(velocity / 3, 30);
  const scale = 1 + Math.min(velocity / 100, 0.3);
  dynamicStyle.textContent = `
    body::after {
      opacity: ${currentIntensity} !important;
      filter: blur(${blurAmount}px) !important;
      transform: translate(-50%, -50%) scale(${scale}) !important;
    }
  `;
  requestAnimationFrame(updateLight);
}
document.addEventListener('mousemove', (e) => {
  mouseX = e.clientX;
  mouseY = e.clientY;
  const deltaX = mouseX - lastMouseX;
  const deltaY = mouseY - lastMouseY;
  velocity = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
  targetIntensity = Math.min(0.4 + (velocity / 15), 1);
  lastMouseX = mouseX;
  lastMouseY = mouseY;
});
let mouseStopTimer;
document.addEventListener('mousemove', () => {
  clearTimeout(mouseStopTimer);
  mouseStopTimer = setTimeout(() => {
    velocity = 0;
    targetIntensity = 0.4;
  }, 100);
});
updateLight();
const beans = document.querySelectorAll('.coffee-bean');
const mouse = { x: 0, y: 0 };
document.addEventListener('mousemove', (e) => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
  beans.forEach((bean) => {
    const rect = bean.getBoundingClientRect();
    const beanX = rect.left + rect.width / 2;
    const beanY = rect.top + rect.height / 2;
    const distance = Math.sqrt(
      Math.pow(mouse.x - beanX, 2) + Math.pow(mouse.y - beanY, 2)
    );
    if (distance < 150) {
      const angle = Math.atan2(mouse.y - beanY, mouse.x - beanX);
      const moveX = Math.cos(angle) * (150 - distance) * 0.3;
      const moveY = Math.sin(angle) * (150 - distance) * 0.3;
      const scale = 1 + (150 - distance) / 150 * 0.3;
      const opacity = 0.4 + (150 - distance) / 150 * 0.4;
      bean.style.transform = `translate(${moveX}px, ${moveY}px) rotate(${moveX * 2}deg) scale(${scale})`;
      bean.style.opacity = opacity;
    } else {
      bean.style.transform = '';
      bean.style.opacity = '';
    }
  });
});
(function() {
  function initGame() {
    const canvas = document.getElementById('gameCanvas');
    if (!canvas) {
      console.error('Canvas not found');
      setTimeout(initGame, 100);
      return;
    }
    const ctx = canvas.getContext('2d');
    if (!ctx) {
      console.error('Could not get 2d context');
      return;
    }
    const scoreEl = document.getElementById('score');
    const livesEl = document.getElementById('lives');
    if (!scoreEl || !livesEl) {
      console.error('Score or lives element not found');
      setTimeout(initGame, 100);
      return;
    }
    function resizeCanvas() {
      canvas.width = canvas.offsetWidth || 800;
      canvas.height = 500;
      ground.y = canvas.height - 100;
    }
    let score = 0;
    let lives = 3;
    let gameRunning = false;
    let gameStarted = false;
    const player = {
      x: 50,
      y: 350,
      width: 60,
      height: 75,
      velocityX: 0,
      velocityY: 0,
      speed: 5,
      jumpPower: -15,
      onGround: false,
      image: new Image()
    };
    player.image.src = 'americano.png';
    const ground = {
      y: canvas.height - 100,
      height: 100
    };
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    const platforms = [
      { x: 300, y: 300, width: 150, height: 20 },
      { x: 600, y: 250, width: 150, height: 20 },
      { x: 900, y: 200, width: 150, height: 20 },
      { x: 1200, y: 300, width: 150, height: 20 }
    ];
    const coins = [
      { x: 350, y: 260, width: 25, height: 15, collected: false },
      { x: 650, y: 210, width: 25, height: 15, collected: false },
      { x: 950, y: 160, width: 25, height: 15, collected: false },
      { x: 1250, y: 260, width: 25, height: 15, collected: false },
      { x: 500, y: 310, width: 25, height: 15, collected: false },
      { x: 800, y: 310, width: 25, height: 15, collected: false },
      { x: 1100, y: 310, width: 25, height: 15, collected: false }
    ];
    const enemies = [
      { x: 400, y: 350, width: 30, height: 30, velocityX: -2, direction: -1, velocityY: 0 },
      { x: 700, y: 300, width: 30, height: 30, velocityX: -2, direction: -1, velocityY: 0 },
      { x: 1000, y: 250, width: 30, height: 30, velocityX: -2, direction: -1, velocityY: 0 }
    ];
    let cameraX = 0;
    const keys = {};
    document.addEventListener('keydown', (e) => {
      keys[e.key] = true;
      if ((e.key === ' ' || e.key === 'ArrowUp') && gameRunning) {
        e.preventDefault();
        if (player.onGround) {
          player.velocityY = player.jumpPower;
          player.onGround = false;
        }
      }
    });
    document.addEventListener('keyup', (e) => {
      keys[e.key] = false;
    });
    function checkCollision(rect1, rect2) {
      return rect1.x < rect2.x + rect2.width &&
             rect1.x + rect1.width > rect2.x &&
             rect1.y < rect2.y + rect2.height &&
             rect1.y + rect1.height > rect2.y;
    }
    function updatePlayer() {
      if (!gameRunning) return;
      if (keys['ArrowLeft'] || keys['a'] || keys['A']) {
        player.velocityX = -player.speed;
      } else if (keys['ArrowRight'] || keys['d'] || keys['D']) {
        player.velocityX = player.speed;
      } else {
        player.velocityX *= 0.8;
      }
      player.velocityY += 0.8;
      player.x += player.velocityX;
      player.y += player.velocityY;
      player.onGround = false;
      if (player.y + player.height >= ground.y) {
        player.y = ground.y - player.height;
        player.velocityY = 0;
        player.onGround = true;
      }
      platforms.forEach(platform => {
        if (player.x + player.width > platform.x - cameraX &&
            player.x < platform.x - cameraX + platform.width &&
            player.y + player.height > platform.y &&
            player.y < platform.y + platform.height &&
            player.velocityY > 0) {
          player.y = platform.y - player.height;
          player.velocityY = 0;
          player.onGround = true;
        }
      });
      if (player.x < 0) player.x = 0;
      if (player.x > 2000) player.x = 2000;
      cameraX = player.x - canvas.width / 3;
      if (cameraX < 0) cameraX = 0;
      if (cameraX > 2000 - canvas.width) cameraX = 2000 - canvas.width;
    }
    function updateEnemies() {
      enemies.forEach(enemy => {
        enemy.x += enemy.velocityX;
        let onPlatform = false;
        platforms.forEach(platform => {
          if (enemy.x + enemy.width > platform.x &&
              enemy.x < platform.x + platform.width &&
              enemy.y + enemy.height > platform.y &&
              enemy.y < platform.y + platform.height &&
              enemy.velocityY >= 0) {
            enemy.y = platform.y - enemy.height;
            enemy.velocityY = 0;
            onPlatform = true;
          }
        });
        if (!onPlatform && enemy.y + enemy.height < ground.y) {
          enemy.velocityY += 0.8;
          enemy.y += enemy.velocityY;
          if (enemy.y + enemy.height >= ground.y) {
            enemy.y = ground.y - enemy.height;
            enemy.velocityY = 0;
          }
        }
        if (enemy.x <= 0) {
          enemy.velocityX = Math.abs(enemy.velocityX);
          enemy.direction = 1;
        } else if (enemy.x >= 2000 - enemy.width) {
          enemy.velocityX = -Math.abs(enemy.velocityX);
          enemy.direction = -1;
        }
        let atEdge = true;
        platforms.forEach(platform => {
          if (enemy.x + enemy.width / 2 >= platform.x &&
              enemy.x + enemy.width / 2 <= platform.x + platform.width &&
              Math.abs(enemy.y + enemy.height - platform.y) < 5) {
            atEdge = false;
          }
        });
        if (atEdge && Math.abs(enemy.y + enemy.height - ground.y) < 5) {
          if (enemy.x <= 0 || enemy.x >= 2000 - enemy.width) {
            enemy.velocityX *= -1;
            enemy.direction *= -1;
          }
        }
      });
    }
    function checkCoins() {
      coins.forEach(coin => {
        if (!coin.collected) {
          if (checkCollision(player, { x: coin.x, y: coin.y, width: coin.width, height: coin.height })) {
            coin.collected = true;
            score += 10;
            scoreEl.textContent = score;
            const allCollected = coins.every(c => c.collected);
            if (allCollected) {
              showVictoryScreen();
            }
          }
        }
      });
    }
    function showVictoryScreen() {
      gameRunning = false;
      const victoryScreen = document.getElementById('victoryScreen');
      const finalScoreEl = document.getElementById('finalScore');
      const playAgainBtn = document.getElementById('playAgainBtn');
      if (victoryScreen && finalScoreEl) {
        finalScoreEl.textContent = score;
        victoryScreen.classList.remove('hidden');
        if (playAgainBtn) {
          playAgainBtn.addEventListener('click', () => {
            location.reload();
          });
        }
      }
    }
    function checkEnemyCollision() {
      enemies.forEach((enemy, index) => {
        if (checkCollision(player, enemy)) {
          if (player.velocityY > 0 && player.y < enemy.y) {
            enemies.splice(index, 1);
            score += 20;
            scoreEl.textContent = score;
          } else {
            lives--;
            livesEl.textContent = lives;
            player.x = 50;
            player.y = 350;
            player.velocityX = 0;
            player.velocityY = 0;
            cameraX = 0;
            if (lives <= 0) {
              gameRunning = false;
              setTimeout(() => {
                if (confirm('Game Over! Final Score: ' + score + '\nPlay again?')) {
                  location.reload();
                }
              }, 100);
            }
          }
        }
      });
    }
    function draw() {
      ctx.fillStyle = '#87CEEB';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#8B4513';
      ctx.fillRect(0, ground.y, canvas.width, ground.height);
      ctx.fillStyle = '#654321';
      for (let i = 0; i < canvas.width; i += 40) {
        ctx.fillRect(i, ground.y, 20, 20);
      }
      ctx.save();
      ctx.translate(-cameraX, 0);
      ctx.fillStyle = '#8B4513';
      platforms.forEach(platform => {
        ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
        ctx.fillStyle = '#654321';
        ctx.fillRect(platform.x, platform.y, platform.width, 5);
        ctx.fillStyle = '#8B4513';
      });
      const coinTime = Date.now() / 200;
      coins.forEach(coin => {
        if (!coin.collected) {
          const coinY = coin.y + Math.sin(coinTime + coin.x) * 3;
          const centerX = coin.x + coin.width / 2;
          const centerY = coinY + coin.height / 2;
          ctx.save();
          ctx.translate(centerX, centerY);
          ctx.rotate(Math.sin(coinTime + coin.x) * 0.1);
          ctx.fillStyle = '#3E2723';
          ctx.beginPath();
          ctx.ellipse(0, 0, coin.width / 2, coin.height / 2, 0, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = '#5D4037';
          ctx.beginPath();
          ctx.ellipse(-coin.width / 6, -coin.height / 6, coin.width / 4, coin.height / 3, 0, 0, Math.PI * 2);
          ctx.fill();
          ctx.strokeStyle = '#1B0000';
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(-coin.width / 3, 0);
          ctx.lineTo(coin.width / 3, 0);
          ctx.stroke();
          ctx.restore();
        }
      });
      enemies.forEach(enemy => {
        ctx.fillStyle = '#ff0000';
        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
        ctx.fillStyle = '#fff';
        ctx.fillRect(enemy.x + 5, enemy.y + 5, 8, 8);
        ctx.fillRect(enemy.x + 17, enemy.y + 5, 8, 8);
        ctx.fillStyle = '#000';
        ctx.fillRect(enemy.x + 7, enemy.y + 7, 4, 4);
        ctx.fillRect(enemy.x + 19, enemy.y + 7, 4, 4);
      });
      if (player.image.complete && player.image.naturalWidth > 0) {
        ctx.drawImage(player.image, player.x, player.y, player.width, player.height);
      } else {
        ctx.fillStyle = '#ff8c00';
        ctx.fillRect(player.x, player.y, player.width, player.height);
        ctx.fillStyle = '#fff';
        ctx.fillRect(player.x + 10, player.y + 10, 8, 8);
        ctx.fillRect(player.x + 22, player.y + 10, 8, 8);
      }
      ctx.restore();
    }
    function gameLoop() {
      if (!gameRunning) return;
      updatePlayer();
      updateEnemies();
      checkCoins();
      checkEnemyCollision();
      draw();
      requestAnimationFrame(gameLoop);
    }
    player.image.onload = () => {
      if (!gameStarted) {
        draw();
      }
    };
    player.image.onerror = () => {
      if (!gameStarted) {
        draw();
      }
    };
    const startBtn = document.getElementById('startGameBtn');
    if (startBtn) {
      startBtn.addEventListener('click', () => {
        if (!gameStarted) {
          gameStarted = true;
          gameRunning = true;
          startBtn.classList.add('hidden');
          score = 0;
          lives = 3;
          scoreEl.textContent = score;
          livesEl.textContent = lives;
          player.x = 50;
          player.y = 350;
          player.velocityX = 0;
          player.velocityY = 0;
          cameraX = 0;
          coins.forEach(coin => {
            coin.collected = false;
          });
          enemies.length = 0;
          enemies.push(
            { x: 400, y: 350, width: 30, height: 30, velocityX: -2, direction: -1, velocityY: 0 },
            { x: 700, y: 300, width: 30, height: 30, velocityX: -2, direction: -1, velocityY: 0 },
            { x: 1000, y: 250, width: 30, height: 30, velocityX: -2, direction: -1, velocityY: 0 }
          );
          if (player.image.complete && player.image.naturalWidth > 0) {
            gameLoop();
          } else {
            setTimeout(() => {
              if (gameRunning) gameLoop();
            }, 100);
          }
        }
      });
    }
    draw();
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initGame);
  } else {
    setTimeout(initGame, 100);
  }
})();
</script>
</body>
</html>
